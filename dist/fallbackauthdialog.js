!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=536)}({536:function(e,t,r){var n=r(537);Office.initialize=function(){Office.context.ui.messageParent&&(i.handleRedirectCallback(a),"yes"===localStorage.getItem("loggedIn")?i.acquireTokenRedirect(o):i.loginRedirect(o))};var o={scopes:["https://graph.microsoft.com/User.Read"]},i=new n.UserAgentApplication({auth:{clientId:"83fae392-2ceb-4671-aab2-3bcacbf967ef",authority:"https://login.microsoftonline.com/common",redirectUri:"https://frosty-archimedes-0b2d91.netlify.app/fallbackauthdialog.html",navigateToLoginRequestUrl:!1},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0}});function a(e,t){e?(console.log(e),Office.context.ui.messageParent(JSON.stringify({status:"failure",result:e}))):"id_token"===t.tokenType?(console.log(t.idToken.rawIdToken),localStorage.setItem("loggedIn","yes")):(console.log("token type is:"+t.tokenType),Office.context.ui.messageParent(JSON.stringify({status:"success",result:t.accessToken})))}},537:function(e,t,r){"use strict";r.r(t),r.d(t,"UserAgentApplication",(function(){return Dt})),r.d(t,"Logger",(function(){return st})),r.d(t,"LogLevel",(function(){return tt})),r.d(t,"Account",(function(){return Ce})),r.d(t,"Constants",(function(){return p})),r.d(t,"ServerHashParamKeys",(function(){return c})),r.d(t,"Authority",(function(){return rt})),r.d(t,"CryptoUtils",(function(){return d})),r.d(t,"UrlUtils",(function(){return me})),r.d(t,"WindowUtils",(function(){return Ae})),r.d(t,"AuthError",(function(){return b})),r.d(t,"ClientAuthError",(function(){return J})),r.d(t,"ServerError",(function(){return ft})),r.d(t,"ClientConfigurationError",(function(){return fe})),r.d(t,"InteractionRequiredAuthError",(function(){return vt}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function s(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var c,u,l,h,d=function(){function e(){}return e.createNewGuid=function(){var t=window.crypto;if(t&&t.getRandomValues){var r=new Uint8Array(16);return t.getRandomValues(r),r[6]|=64,r[6]&=79,r[8]|=128,r[8]&=191,e.decimalToHex(r[0])+e.decimalToHex(r[1])+e.decimalToHex(r[2])+e.decimalToHex(r[3])+"-"+e.decimalToHex(r[4])+e.decimalToHex(r[5])+"-"+e.decimalToHex(r[6])+e.decimalToHex(r[7])+"-"+e.decimalToHex(r[8])+e.decimalToHex(r[9])+"-"+e.decimalToHex(r[10])+e.decimalToHex(r[11])+e.decimalToHex(r[12])+e.decimalToHex(r[13])+e.decimalToHex(r[14])+e.decimalToHex(r[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="0123456789abcdef",i=0,a="",s=0;s<36;s++)"-"!==n[s]&&"4"!==n[s]&&(i=16*Math.random()|0),"x"===n[s]?a+=o[i]:"y"===n[s]?(i&=3,a+=o[i|=8]):a+=n[s];return a},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(Number("0x"+t))})))},e.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))},e.deserialize=function(e){var t,r=/\+/g,n=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(decodeURIComponent(e.replace(r," ")))},i={};for(t=n.exec(e);t;)i[o(t[1])]=o(t[2]),t=n.exec(e);return i},e}(),p=function(){function e(){}return Object.defineProperty(e,"libraryName",{get:function(){return"Msal.js"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"claims",{get:function(){return"claims"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cachePrefix",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"scopes",{get:function(){return"scopes"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"upn",{get:function(){return"upn"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"domain_hint",{get:function(){return"domain_hint"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt",{get:function(){return"prompt"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"resourceDelimiter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cacheDelimiter",{get:function(){return"."},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"common",{get:function(){return"common"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"openidScope",{get:function(){return"openid"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"profileScope",{get:function(){return"profile"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeSilent",{get:function(){return"silentInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"inProgress",{get:function(){return"inProgress"},enumerable:!0,configurable:!0}),e._popUpWidth=483,e._popUpHeight=600,e}();!function(e){e.SCOPE="scope",e.STATE="state",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.EXPIRES_IN="expires_in",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info"}(c||(c={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",e.SESSION_STATE="session.state",e.STATE_LOGIN="state.login",e.STATE_ACQ_TOKEN="state.acquireToken",e.STATE_RENEW="state.renew",e.NONCE_IDTOKEN="nonce.idtoken",e.LOGIN_REQUEST="login.request",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.INTERACTION_STATUS="interaction_status",e.REDIRECT_REQUEST="redirect_request"}(u||(u={})),function(e){e.IDTOKEN="idtoken",e.CLIENT_INFO="client.info"}(l||(l={})),function(e){e.LOGIN_ERROR="login.error",e.ERROR="error",e.ERROR_DESC="error.description"}(h||(h={}));var f,g={"login.windows.net":"login.windows.net","login.chinacloudapi.cn":"login.chinacloudapi.cn","login.cloudgovapi.us":"login.cloudgovapi.us","login.microsoftonline.com":"login.microsoftonline.com","login.microsoftonline.de":"login.microsoftonline.de","login.microsoftonline.us":"login.microsoftonline.us"};!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(f||(f={}));var m=[f.SID,f.LOGIN_HINT],y={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"},v="msalIdTokenFrame",I="msalRenewFrame";var w,E={code:"unexpected_error",desc:"Unexpected error in authentication."},T={code:"no_window_object",desc:"No window object available. Details:"},b=function(e){function t(r,n){var o=e.call(this,n)||this;return Object.setPrototypeOf(o,t.prototype),o.errorCode=r,o.errorMessage=n,o.name="AuthError",o}return o(t,e),t.createUnexpectedError=function(e){return new t(E.code,E.desc+": "+e)},t.createNoWindowObjectError=function(e){return new t(T.code,T.desc+" "+e)},t}(Error),S=function(){function e(){}return e.isEmpty=function(e){return void 0===e||!e||0===e.length},e}(),C={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements like authority."},A={code:"multiple_authorities",desc:"Multiple authorities found in the cache. Pass authority in the API overload."},k={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},_={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},O={code:"token_renewal_error",desc:"Token renewal operation failed due to timeout."},R={code:"invalid_id_token",desc:"Invalid ID token format."},P={code:"invalid_state_error",desc:"Invalid state."},N={code:"nonce_mismatch_error",desc:"Nonce is not matching, Nonce received: "},U={code:"login_progress_error",desc:"Login_In_Progress: Error during login call - login is already in progress."},x={code:"acquiretoken_progress_error",desc:"AcquireToken_In_Progress: Error during login call - login is already in progress."},L={code:"user_cancelled",desc:"User cancelled the flow."},q={code:"callback_error",desc:"Error occurred in token received callback function."},M={code:"user_login_error",desc:"User login is required. For silent calls, request must contain either sid or login_hint"},D={code:"user_non_existent",desc:"User object does not exist. Please call a login API."},j={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},H={code:"client_info_not_populated_error",desc:"The service did not populate client_info in the response, Please verify with the service team"},F={code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},K={code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},G={code:"token_encoding_error",desc:"The token to be decoded is not encoded correctly."},W={code:"invalid_interaction_type",desc:"The interaction type passed to the handler was incorrect or unknown"},Q={code:"cannot_parse_cache",desc:"The cached token key is not a valid JSON and cannot be parsed"},V={code:"block_token_requests",desc:"Token calls are blocked in hidden iframes"},J=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,t.prototype),o}return o(t,e),t.createEndpointResolutionError=function(e){var r=k.desc;return e&&!S.isEmpty(e)&&(r+=" Details: "+e),new t(k.code,r)},t.createMultipleMatchingTokensInCacheError=function(e){return new t(C.code,"Cache error for scope "+e+": "+C.desc+".")},t.createMultipleAuthoritiesInCacheError=function(e){return new t(A.code,"Cache error for scope "+e+": "+A.desc+".")},t.createPopupWindowError=function(e){var r=_.desc;return e&&!S.isEmpty(e)&&(r+=" Details: "+e),new t(_.code,r)},t.createTokenRenewalTimeoutError=function(){return new t(O.code,O.desc)},t.createInvalidIdTokenError=function(e){return new t(R.code,R.desc+" Given token: "+e)},t.createInvalidStateError=function(e,r){return new t(P.code,P.desc+" "+e+", state expected : "+r+".")},t.createNonceMismatchError=function(e,r){return new t(N.code,N.desc+" "+e+", nonce expected : "+r+".")},t.createLoginInProgressError=function(){return new t(U.code,U.desc)},t.createAcquireTokenInProgressError=function(){return new t(x.code,x.desc)},t.createUserCancelledError=function(){return new t(L.code,L.desc)},t.createErrorInCallbackFunction=function(e){return new t(q.code,q.desc+" "+e+".")},t.createUserLoginRequiredError=function(){return new t(M.code,M.desc)},t.createUserDoesNotExistError=function(){return new t(D.code,D.desc)},t.createClientInfoDecodingError=function(e){return new t(j.code,j.desc+" Failed with error: "+e)},t.createClientInfoNotPopulatedError=function(e){return new t(H.code,H.desc+" Failed with error: "+e)},t.createIdTokenNullOrEmptyError=function(e){return new t(F.code,F.desc+" Raw ID Token Value: "+e)},t.createIdTokenParsingError=function(e){return new t(K.code,K.desc+" Failed with error: "+e)},t.createTokenEncodingError=function(e){return new t(G.code,G.desc+" Attempted to decode: "+e)},t.createInvalidInteractionTypeError=function(){return new t(W.code,W.desc)},t.createCacheParseError=function(e){var r="invalid key: "+e+", "+Q.desc;return new t(Q.code,r)},t.createBlockTokenRequestsInHiddenIframeError=function(){return new t(V.code,V.desc)},t}(b),z={code:"no_config_set",desc:"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."},B={code:"storage_not_supported",desc:"The value for the cacheLocation is not supported."},X={code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},Y={code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},$={code:"scopes_required",desc:"Scopes are required to obtain an access token."},Z={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as empty array."},ee={code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},te={code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},re={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'"},ne={code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},oe={code:"authority_uri_insecure",desc:"Authority URIs must use https."},ie={code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},ae={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. If using B2C, please include this authority in the knownAuthorities config parameter."},se={code:"b2c_known_authorities_not_set",desc:"Must set known authorities when validateAuthority is set to True and using B2C"},ce={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},ue={code:"empty_request_error",desc:"Request object is required."},le={code:"invalid_guid_sent_as_correlationId",desc:"Please set the correlationId as a valid guid"},he={code:"telemetry_config_error",desc:"Telemetry config is not configured with required values"},de={code:"sso_silent_error",desc:"request must contain either sid or login_hint"},pe={code:"authority_metadata_error",desc:"Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields."},fe=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,t.prototype),o}return o(t,e),t.createNoSetConfigurationError=function(){return new t(z.code,""+z.desc)},t.createStorageNotSupportedError=function(e){return new t(B.code,B.desc+" Given location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(X.code,X.desc)},t.createInvalidCallbackObjectError=function(e){return new t(Y.code,Y.desc+" Given value for callback function: "+e)},t.createEmptyScopesArrayError=function(e){return new t(Z.code,Z.desc+" Given value: "+e+".")},t.createScopesNonArrayError=function(e){return new t(ee.code,ee.desc+" Given value: "+e+".")},t.createClientIdSingleScopeError=function(e){return new t(te.code,te.desc+" Given value: "+e+".")},t.createScopesRequiredError=function(e){return new t($.code,$.desc+" Given value: "+e)},t.createInvalidPromptError=function(e){return new t(re.code,re.desc+" Given value: "+e)},t.createClaimsRequestParsingError=function(e){return new t(ce.code,ce.desc+" Given value: "+e)},t.createEmptyRequestError=function(){var e=ue;return new t(e.code,e.desc)},t.createInvalidCorrelationIdError=function(){return new t(le.code,le.desc)},t.createKnownAuthoritiesNotSetError=function(){return new t(se.code,se.desc)},t.createInvalidAuthorityTypeError=function(){return new t(ne.code,ne.desc)},t.createUntrustedAuthorityError=function(){return new t(ae.code,ae.desc)},t.createTelemetryConfigError=function(e){var r=he,n=r.code,o=r.desc,i={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new t(n,o+" mising values: "+Object.keys(i).reduce((function(t,r){return e[r]?t:t.concat([r+" ("+i[r]+")"])}),[]).join(","))},t.createSsoSilentError=function(){return new t(de.code,de.desc)},t.createInvalidAuthorityMetadataError=function(){return new t(pe.code,pe.desc)},t}(J),ge=function(){function e(){}return e.isIntersectingScopes=function(e,t){for(var r=this.trimAndConvertArrayToLowerCase(e.slice()),n=this.trimAndConvertArrayToLowerCase(t.slice()),o=0;o<n.length;o++)if(r.indexOf(n[o].toLowerCase())>-1)return!0;return!1},e.containsScope=function(e,t){var r=this.trimAndConvertArrayToLowerCase(e.slice());return this.trimAndConvertArrayToLowerCase(t.slice()).every((function(e){return r.indexOf(e.toString().toLowerCase())>=0}))},e.trimAndConvertToLowerCase=function(e){return e.trim().toLowerCase()},e.trimAndConvertArrayToLowerCase=function(e){var t=this;return e.map((function(e){return t.trimAndConvertToLowerCase(e)}))},e.removeElement=function(e,t){var r=this.trimAndConvertToLowerCase(t);return e.filter((function(e){return e!==r}))},e.parseScope=function(e){var t="";if(e)for(var r=0;r<e.length;++r)t+=r!==e.length-1?e[r]+" ":e[r];return t},e.validateInputScope=function(e,t,r){if(e){if(!Array.isArray(e))throw fe.createScopesNonArrayError(e);if(e.length<1)throw fe.createEmptyScopesArrayError(e.toString());if(e.indexOf(r)>-1&&e.length>1)throw fe.createClientIdSingleScopeError(e.toString())}else if(t)throw fe.createScopesRequiredError(e)},e.getScopeFromState=function(e){if(e){var t=e.indexOf(p.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},e.appendScopes=function(e,t){if(e){var r=t?this.trimAndConvertArrayToLowerCase(t.slice()):null,n=this.trimAndConvertArrayToLowerCase(e.slice());return r?n.concat(r):n}return null},e}(),me=function(){function e(){}return e.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),r=e.authorityInstance.AuthorizationEndpoint;return r.indexOf("?")<0?r+="?":r+="&",""+r+t.join("&")},e.createNavigationUrlString=function(e){var t=e.scopes;-1===t.indexOf(e.clientId)&&t.push(e.clientId);var r=[];return r.push("response_type="+e.responseType),this.translateclientIdUsedInScope(t,e.clientId),r.push("scope="+encodeURIComponent(ge.parseScope(t))),r.push("client_id="+encodeURIComponent(e.clientId)),r.push("redirect_uri="+encodeURIComponent(e.redirectUri)),r.push("state="+encodeURIComponent(e.state)),r.push("nonce="+encodeURIComponent(e.nonce)),r.push("client_info=1"),r.push("x-client-SKU="+e.xClientSku),r.push("x-client-Ver="+e.xClientVer),e.promptValue&&r.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&r.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&r.push(e.queryParameters),e.extraQueryParameters&&r.push(e.extraQueryParameters),r.push("client-request-id="+encodeURIComponent(e.correlationId)),r},e.translateclientIdUsedInScope=function(e,t){var r=e.indexOf(t);r>=0&&(e.splice(r,1),-1===e.indexOf("openid")&&e.push("openid"),-1===e.indexOf("profile")&&e.push("profile"))},e.getCurrentUrl=function(){return window.location.href.split("?")[0].split("#")[0]},e.removeHashFromUrl=function(e){return e.split("#")[0]},e.replaceTenantPath=function(e,t){e=e.toLowerCase();var r=this.GetUrlComponents(e),n=r.PathSegments;return t&&0!==n.length&&n[0]===p.common&&(n[0]=t),this.constructAuthorityUriFromObject(r,n)},e.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},e.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=e.match(t);if(!r||r.length<6)throw"Valid url required";var n={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5]},o=n.AbsolutePath.split("/");return o=o.filter((function(e){return e&&e.length>0})),n.PathSegments=o,r[6]&&(n.Search=r[6]),r[8]&&(n.Hash=r[8]),n},e.CanonicalizeUri=function(t){return t&&(t=t.toLowerCase()),t&&!e.endsWith(t,"/")&&(t+="/"),t},e.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},e.urlRemoveQueryStringParameter=function(e,t){if(S.isEmpty(e))return e;var r=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+&"),e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+"),e=e.replace(r,"")},e.getHashFromUrl=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):e},e.urlContainsHash=function(t){var r=e.deserializeHash(t);return r.hasOwnProperty(c.ERROR_DESCRIPTION)||r.hasOwnProperty(c.ERROR)||r.hasOwnProperty(c.ACCESS_TOKEN)||r.hasOwnProperty(c.ID_TOKEN)},e.deserializeHash=function(t){var r=e.getHashFromUrl(t);return d.deserialize(r)},e.getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0]},e}(),ye=function(e,t,r,n,o){this.authority=me.CanonicalizeUri(e),this.clientId=t,this.scopes=r,this.homeAccountIdentifier=d.base64Encode(n)+"."+d.base64Encode(o)},ve=function(e,t,r,n){this.accessToken=e,this.idToken=t,this.expiresIn=r,this.homeAccountIdentifier=n},Ie=function(){function e(e,t,r,n,o,i,a){this.authorityInstance=e,this.clientId=t,this.nonce=d.createNewGuid(),this.scopes=o?o.slice():[t],this.scopes=ge.trimAndConvertArrayToLowerCase(this.scopes),this.state=i,this.correlationId=a,this.xClientSku="MSAL.JS",this.xClientVer="1.3.2",this.responseType=r,this.redirectUri=n}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!0,configurable:!0}),e.prototype.populateQueryParams=function(t,r,n,o){var i={};r&&(r.prompt&&(this.promptValue=r.prompt),r.claimsRequest&&(this.claimsValue=r.claimsRequest),e.isSSOParam(r)&&(i=this.constructUnifiedCacheQueryParameter(r,null))),n&&(i=this.constructUnifiedCacheQueryParameter(null,n)),i=this.addHintParameters(t,i);var a=r?r.extraQueryParameters:null;this.queryParameters=e.generateQueryParametersString(i),this.extraQueryParameters=e.generateQueryParametersString(a,o)},e.prototype.constructUnifiedCacheQueryParameter=function(e,t){var r,n;if(e)if(e.account){var o=e.account;o.sid?(r=f.SID,n=o.sid):o.userName&&(r=f.LOGIN_HINT,n=o.userName)}else e.sid?(r=f.SID,n=e.sid):e.loginHint&&(r=f.LOGIN_HINT,n=e.loginHint);else t&&t.hasOwnProperty(p.upn)&&(r=f.ID_TOKEN,n=t.upn);return this.addSSOParameter(r,n)},e.prototype.addHintParameters=function(e,t){e&&!t[f.SID]&&(!t[f.LOGIN_HINT]&&e.sid&&this.promptValue===y.NONE?t=this.addSSOParameter(f.SID,e.sid,t):!t[f.LOGIN_HINT]&&e.userName&&!S.isEmpty(e.userName)&&(t=this.addSSOParameter(f.LOGIN_HINT,e.userName,t)));return t},e.prototype.addSSOParameter=function(e,t,r){if(r||(r={}),!t)return r;switch(e){case f.SID:r[f.SID]=t;break;case f.ID_TOKEN:case f.LOGIN_HINT:r[f.LOGIN_HINT]=t}return r},e.generateQueryParametersString=function(e,t){var r=null;return e&&Object.keys(e).forEach((function(n){n===p.domain_hint&&(t||e[f.SID])||(null==r?r=n+"="+encodeURIComponent(e[n]):r+="&"+n+"="+encodeURIComponent(e[n]))})),r},e.isSSOParam=function(e){return e&&(e.account||e.sid||e.loginHint)},e}(),we=function(){function e(e){if(!e||S.isEmpty(e))return this.uid="",void(this.utid="");try{var t=d.base64Decode(e),r=JSON.parse(t);r&&(r.hasOwnProperty("uid")&&(this.uid=r.uid),r.hasOwnProperty("utid")&&(this.utid=r.utid))}catch(e){throw J.createClientInfoDecodingError(e)}}return Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!0,configurable:!0}),e}(),Ee=function(){function e(){}return e.decodeJwt=function(e){if(S.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,n=d.base64Decode(r);return n?JSON.parse(n):null}catch(e){}return null},e}(),Te=function(e){if(S.isEmpty(e))throw J.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=Ee.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")&&(this.preferredName=this.claims.preferred_username),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(e){throw J.createIdTokenParsingError(e)}},be=function(e,t){this.key=e,this.value=t},Se=function(e){function t(t,r,n){var o=e.call(this,r)||this;return o.clientId=t,o.rollbackEnabled=!0,o.migrateCacheEntries(n),o}return o(t,e),t.prototype.migrateCacheEntries=function(t){var r=this,n=p.cachePrefix+"."+l.IDTOKEN,o=p.cachePrefix+"."+l.CLIENT_INFO,i=p.cachePrefix+"."+h.ERROR,a=p.cachePrefix+"."+h.ERROR_DESC,s=[e.prototype.getItem.call(this,n),e.prototype.getItem.call(this,o),e.prototype.getItem.call(this,i),e.prototype.getItem.call(this,a)];[l.IDTOKEN,l.CLIENT_INFO,h.ERROR,h.ERROR_DESC].forEach((function(e,n){return r.duplicateCacheEntry(e,s[n],t)}))},t.prototype.duplicateCacheEntry=function(e,t,r){t&&this.setItem(e,t,r)},t.prototype.generateCacheKey=function(e,t){try{return JSON.parse(e),e}catch(r){return 0===e.indexOf(""+p.cachePrefix)||0===e.indexOf(p.adalIdToken)?e:t?p.cachePrefix+"."+this.clientId+"."+e:p.cachePrefix+"."+e}},t.prototype.setItem=function(t,r,n,o){e.prototype.setItem.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&e.prototype.setItem.call(this,this.generateCacheKey(t,!1),r,n)},t.prototype.getItem=function(t,r){return e.prototype.getItem.call(this,this.generateCacheKey(t,!0),r)},t.prototype.removeItem=function(t){e.prototype.removeItem.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.removeItem.call(this,this.generateCacheKey(t,!1))},t.prototype.resetCacheItems=function(){var t,r=window[this.cacheLocation];for(t in r)r.hasOwnProperty(t)&&-1!==t.indexOf(p.cachePrefix)&&e.prototype.removeItem.call(this,t)},t.prototype.resetTempCacheItems=function(e){var t,r=window[this.cacheLocation];for(t in r)e&&-1===t.indexOf(e)||this.tokenRenewalInProgress(e)||(this.removeItem(t),this.setItemCookie(t,"",-1),this.clearMsalCookie(e));this.removeItem(u.INTERACTION_STATUS),this.removeItem(u.REDIRECT_REQUEST)},t.prototype.setItemCookie=function(t,r,n){e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!1),r,n)},t.prototype.getItemCookie=function(t){return e.prototype.getItemCookie.call(this,this.generateCacheKey(t,!0))},t.prototype.getAllAccessTokens=function(e,t){var r=this;return Object.keys(window[this.cacheLocation]).reduce((function(n,o){if(o.match(e)&&o.match(t)&&o.match(p.scopes)){var i=r.getItem(o);if(i)try{var a=JSON.parse(o),s=new be(a,JSON.parse(i));return n.concat([s])}catch(e){throw J.createCacheParseError(o)}}return n}),[])},t.prototype.tokenRenewalInProgress=function(e){var t=this.getItem(u.RENEW_STATUS+"|"+e);return!(!t||t!==p.inProgress)},t.prototype.clearMsalCookie=function(e){this.clearItemCookie(u.NONCE_IDTOKEN+"|"+e),this.clearItemCookie(u.STATE_LOGIN+"|"+e),this.clearItemCookie(u.LOGIN_REQUEST+"|"+e),this.clearItemCookie(u.STATE_ACQ_TOKEN+"|"+e)},t.generateAcquireTokenAccountKey=function(e,t){return""+u.ACQUIRE_TOKEN_ACCOUNT+p.resourceDelimiter+e+p.resourceDelimiter+t},t.generateAuthorityKey=function(e){return""+u.AUTHORITY+p.resourceDelimiter+e},t}(function(){function e(e){if(!window)throw b.createNoWindowObjectError("Browser storage class could not find window object");if(!(void 0!==window[e]&&null!=window[e]))throw fe.createStorageNotSupportedError(e);this.cacheLocation=e}return e.prototype.setItem=function(e,t,r){window[this.cacheLocation].setItem(e,t),r&&this.setItemCookie(e,t)},e.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation].getItem(e)},e.prototype.removeItem=function(e){return window[this.cacheLocation].removeItem(e)},e.prototype.clear=function(){return window[this.cacheLocation].clear()},e.prototype.setItemCookie=function(e,t,r){var n=e+"="+t+";path=/;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";");document.cookie=n},e.prototype.getItemCookie=function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""},e.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},e.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},e}()),Ce=function(){function e(e,t,r,n,o,i,a){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=r,this.name=n,this.idToken=o,this.idTokenClaims=o,this.sid=i,this.environment=a}return e.createAccount=function(t,r){var n,o=t.objectId||t.subject,i=r?r.uid:"",a=r?r.utid:"";return S.isEmpty(i)||S.isEmpty(a)||(n=d.base64Encode(i)+"."+d.base64Encode(a)),new e(o,n,t.preferredName,t.name,t.claims,t.sid,t.issuer)},e.compareAccounts=function(e,t){return!(!e||!t)&&!(!e.homeAccountIdentifier||!t.homeAccountIdentifier||e.homeAccountIdentifier!==t.homeAccountIdentifier)},e}(),Ae=function(){function e(){}return e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return!(!window.opener||window.opener===window)},e.generateFrameName=function(e,t){return""+e+p.resourceDelimiter+t},e.monitorWindowForHash=function(t,r,n,o,i){return new Promise((function(a,s){var c=r/e.POLLING_INTERVAL_MS,u=0;o.verbose("monitorWindowForHash polling started");var l=setInterval((function(){if(t.closed)return o.error("monitorWindowForHash window closed"),clearInterval(l),void s(J.createUserCancelledError());var e;try{e=t.location.href}catch(e){}if(i)u++;else{if(!e||"about:blank"===e)return;u++}e&&me.urlContainsHash(e)?(o.verbose("monitorWindowForHash found url in hash"),clearInterval(l),a(t.location.hash)):u>c&&(o.error("monitorWindowForHash unable to find hash in url, timing out"),o.errorPii("monitorWindowForHash polling timed out for url: "+n),clearInterval(l),s(J.createTokenRenewalTimeoutError()))}),e.POLLING_INTERVAL_MS)}))},e.loadFrame=function(e,t,r,n){var o=this;return n.infoPii("LoadFrame: "+t),new Promise((function(i,a){setTimeout((function(){var r=o.loadFrameSync(e,t,n);r?i(r):a("Unable to load iframe with name: "+t)}),r)}))},e.loadFrameSync=function(t,r,n){var o=e.addHiddenIFrame(r,n);return o?(""!==o.src&&"about:blank"!==o.src||(o.src=t,n.infoPii("Frame Name : "+r+" Navigated to: "+t)),o):null},e.addHiddenIFrame=function(e,t){if(void 0===e)return null;t.infoPii("Add msal frame to document:"+e);var r=document.getElementById(e);if(!r){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var n=document.createElement("iframe");n.setAttribute("id",e),n.setAttribute("aria-hidden","true"),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),r=document.getElementsByTagName("body")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(r=window.frames[e])}return r},e.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},e.getIframeWithHash=function(e){var t=document.getElementsByTagName("iframe");return Array.apply(null,Array(t.length)).map((function(e,r){return t.item(r)})).filter((function(t){try{return t.contentWindow.location.hash===e}catch(e){return!1}}))[0]},e.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},e.getPopUpWithHash=function(t){return e.getPopups().filter((function(e){try{return e.location.hash===t}catch(e){return!1}}))[0]},e.trackPopup=function(t){e.getPopups().push(t)},e.closePopups=function(){e.getPopups().forEach((function(e){return e.close()}))},e.blockReloadInHiddenIframes=function(){if(me.urlContainsHash(window.location.hash)&&e.isInIframe())throw J.createBlockTokenRequestsInHiddenIframeError()},e.checkIfBackButtonIsPressed=function(e){var t=e.getItem(u.REDIRECT_REQUEST);if(t&&!me.urlContainsHash(window.location.hash)){var r=t.split(p.resourceDelimiter),n=r.length>1?r[r.length-1]:null;e.resetTempCacheItems(n)}},e.POLLING_INTERVAL_MS=50,e}(),ke=function(){function e(){}return e.parseExpiresIn=function(e){return e||(e="3599"),parseInt(e,10)},e.now=function(){return Math.round((new Date).getTime()/1e3)},e}(),_e=function(){function e(){}return e.validateRequest=function(e,t,r,n){if(!t&&!e)throw fe.createEmptyRequestError();var o,a;e&&(o=t?ge.appendScopes(e.scopes,e.extraScopesToConsent):e.scopes,ge.validateInputScope(o,!t,r),this.validatePromptParameter(e.prompt),a=this.validateEQParameters(e.extraQueryParameters,e.claimsRequest),this.validateClaimsRequest(e.claimsRequest));var s=this.validateAndGenerateState(e&&e.state,n),c=this.validateAndGenerateCorrelationId(e&&e.correlationId);return i({},e,{extraQueryParameters:a,scopes:o,state:s,correlationId:c})},e.validatePromptParameter=function(e){if(e&&[y.LOGIN,y.SELECT_ACCOUNT,y.CONSENT,y.NONE].indexOf(e)<0)throw fe.createInvalidPromptError(e)},e.validateEQParameters=function(e,t){var r=i({},e);return r?(t&&delete r[p.claims],m.forEach((function(e){r[e]&&delete r[e]})),r):null},e.validateClaimsRequest=function(e){if(e)try{JSON.parse(e)}catch(e){throw fe.createClaimsRequestParsingError(e)}},e.validateAndGenerateState=function(t,r){return S.isEmpty(t)?e.generateLibraryState(r):""+e.generateLibraryState(r)+p.resourceDelimiter+t},e.generateLibraryState=function(e){var t={id:d.createNewGuid(),ts:ke.now(),method:e},r=JSON.stringify(t);return d.base64Encode(r)},e.parseLibraryState=function(e){var t=decodeURIComponent(e).split(p.resourceDelimiter)[0];if(d.isGuid(t))return{id:t,ts:ke.now(),method:p.interactionTypeRedirect};try{var r=d.base64Decode(t);return JSON.parse(r)}catch(t){throw J.createInvalidStateError(e,null)}},e.validateAndGenerateCorrelationId=function(e){if(e&&!d.isGuid(e))throw fe.createInvalidCorrelationIdError();return d.isGuid(e)?e:d.createNewGuid()},e.createRequestSignature=function(e){return""+e.scopes.join(" ").toLowerCase()+p.resourceDelimiter+e.authority},e}(),Oe=function(){function e(){}return e.setResponseIdToken=function(e,t){if(!e)return null;if(!t)return e;var r=Number(t.expiration);return r&&!e.expiresOn&&(e.expiresOn=new Date(1e3*r)),i({},e,{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},e}(),Re=function(){function e(){}return e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise((function(r,o){var i=new XMLHttpRequest;if(i.open(t,e,!0),i.onload=function(e){var t;(i.status<200||i.status>=300)&&o(n.handleError(i.responseText));try{t=JSON.parse(i.responseText)}catch(e){o(n.handleError(i.responseText))}var a={statusCode:i.status,body:t};r(a)},i.onerror=function(e){o(i.status)},"GET"!==t)throw"not implemented";i.send()}))},e.prototype.handleError=function(e){var t;try{if((t=JSON.parse(e)).error)return t.error;throw e}catch(t){return e}},e}(),Pe="Microsoft.MSAL.correlation_id",Ne="msal.api_telem_id",Ue="msal.api_id",xe="Microsoft_MSAL_cache_event_count",Le="Microsoft_MSAL_http_event_count",qe="Microsoft_MSAL_ui_event_count",Me=function(e){var t=me.GetUrlComponents(e);if(!g[t.HostNameAndPort.toLocaleLowerCase()])return e;var r=t.PathSegments;if(r&&r.length>=2){var n="tfp"===r[1]?2:1;n<r.length&&(r[n]="<tenant>")}return t.Protocol+"//"+t.HostNameAndPort+"/"+r.join("/")},De=function(e){return d.base64Encode(e)},je=function(e){return"msal."+(e||"")},He=function(){return!!("undefined"!=typeof window&&"performance"in window&&window.performance.mark&&window.performance.measure)},Fe=function(){function e(e,t,r){var n;this.eventId=d.createNewGuid(),this.label=r,this.event=((n={})[je("event_name")]=e,n[je("elapsed_time")]=-1,n[""+Pe]=t,n)}return e.prototype.setElapsedTime=function(e){this.event[je("elapsed_time")]=e},e.prototype.stop=function(){var e,t,r;this.setElapsedTime(+Date.now()-+this.startTimestamp),e=this.displayName,t=this.perfStartMark,r=this.perfEndMark,He()&&(window.performance.mark(r),window.performance.measure(e,t,r),window.performance.clearMeasures(e),window.performance.clearMarks(t),window.performance.clearMarks(r))},e.prototype.start=function(){var e;this.startTimestamp=Date.now(),this.event[je("start_time")]=this.startTimestamp,e=this.perfStartMark,He()&&window.performance.mark(e)},Object.defineProperty(e.prototype,"telemetryCorrelationId",{get:function(){return this.event[""+Pe]},set:function(e){this.event[""+Pe]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventName",{get:function(){return this.event[je("event_name")]},enumerable:!0,configurable:!0}),e.prototype.get=function(){return i({},this.event,{eventId:this.eventId})},Object.defineProperty(e.prototype,"key",{get:function(){return this.telemetryCorrelationId+"_"+this.eventId+"-"+this.eventName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return"Msal-"+this.label+"-"+this.telemetryCorrelationId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"perfStartMark",{get:function(){return"start-"+this.key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"perfEndMark",{get:function(){return"end-"+this.key},enumerable:!0,configurable:!0}),e}(),Ke=je("http_path"),Ge=je("user_agent"),We=je("query_parameters"),Qe=je("api_version"),Ve=je("response_code"),Je=je("oauth_error_code"),ze=je("http_method"),Be=je("request_id_header"),Xe=je("spe_info"),Ye=je("server_error_code"),$e=je("server_sub_error_code"),Ze=je("url"),et=function(e){function t(t,r){return e.call(this,je("http_event"),t,r)||this}return o(t,e),Object.defineProperty(t.prototype,"url",{set:function(e){var t=Me(e);this.event[Ze]=t&&t.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpPath",{set:function(e){this.event[Ke]=Me(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userAgent",{set:function(e){this.event[Ge]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"queryParams",{set:function(e){this.event[We]=Ie.generateQueryParametersString(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiVersion",{set:function(e){this.event[Qe]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpResponseStatus",{set:function(e){this.event[Ve]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"oAuthErrorCode",{set:function(e){this.event[Je]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpMethod",{set:function(e){this.event[ze]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requestIdHeader",{set:function(e){this.event[Be]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speInfo",{set:function(e){this.event[Xe]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverErrorCode",{set:function(e){this.event[Ye]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverSubErrorCode",{set:function(e){this.event[$e]=e},enumerable:!0,configurable:!0}),t}(Fe);!function(e){e[e.Aad=0]="Aad",e[e.Adfs=1]="Adfs",e[e.B2C=2]="B2C"}(w||(w={}));var tt,rt=function(){function e(e,t,r){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri(),this.tenantDiscoveryResponse=r}return Object.defineProperty(e.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),e.prototype.validateResolved=function(){if(!this.hasCachedMetadata())throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(e.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=me.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=me.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),e.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(e){throw ne}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw oe;if(!e.PathSegments||e.PathSegments.length<1)throw ie},e.prototype.DiscoverEndpoints=function(e,t,r){var n=new Re,o=new et(r,"openIdConfigurationEndpoint");return o.url=e,o.httpMethod="GET",t.startEvent(o),n.sendRequestAsync(e,"GET",!0).then((function(e){return o.httpResponseStatus=e.statusCode,t.stopEvent(o),{AuthorizationEndpoint:e.body.authorization_endpoint,EndSessionEndpoint:e.body.end_session_endpoint,Issuer:e.body.issuer}})).catch((function(e){throw o.serverErrorCode=e,t.stopEvent(o),e}))},e.prototype.resolveEndpointsAsync=function(e,t){return a(this,void 0,void 0,(function(){var r,n;return s(this,(function(o){switch(o.label){case 0:return[4,this.GetOpenIdConfigurationEndpointAsync(e,t)];case 1:return r=o.sent(),n=this,[4,this.DiscoverEndpoints(r,e,t)];case 2:return n.tenantDiscoveryResponse=o.sent(),[2,this.tenantDiscoveryResponse]}}))}))},e.prototype.hasCachedMetadata=function(){return!!(this.tenantDiscoveryResponse&&this.tenantDiscoveryResponse.AuthorizationEndpoint&&this.tenantDiscoveryResponse.EndSessionEndpoint&&this.tenantDiscoveryResponse.Issuer)},e}(),nt=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return o(t,e),Object.defineProperty(t.prototype,"AadInstanceDiscoveryEndpointUrl",{get:function(){return t.AadInstanceDiscoveryEndpoint+"?api-version=1.0&authorization_endpoint="+this.CanonicalAuthority+"oauth2/v2.0/authorize"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AuthorityType",{get:function(){return w.Aad},enumerable:!0,configurable:!0}),t.prototype.GetOpenIdConfigurationEndpointAsync=function(e,t){return a(this,void 0,void 0,(function(){var r,n;return s(this,(function(o){return!this.IsValidationEnabled||this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort)?[2,this.DefaultOpenIdConfigurationEndpoint]:(r=new Re,"GET",n=e.createAndStartHttpEvent(t,"GET",this.AadInstanceDiscoveryEndpointUrl,"AadInstanceDiscoveryEndpoint"),[2,r.sendRequestAsync(this.AadInstanceDiscoveryEndpointUrl,"GET",!0).then((function(t){return n.httpResponseStatus=t.statusCode,e.stopEvent(n),t.body.tenant_discovery_endpoint})).catch((function(t){throw n.serverErrorCode=t,e.stopEvent(n),t}))])}))}))},t.prototype.IsInTrustedHostList=function(e){return g[e.toLowerCase()]},t.AadInstanceDiscoveryEndpoint="https://login.microsoftonline.com/common/discovery/instance",t}(rt),ot={},it=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return o(t,e),Object.defineProperty(t.prototype,"AuthorityType",{get:function(){return w.B2C},enumerable:!0,configurable:!0}),t.prototype.GetOpenIdConfigurationEndpointAsync=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(e){if(!this.IsValidationEnabled||this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort))return[2,this.DefaultOpenIdConfigurationEndpoint];throw fe.createUntrustedAuthorityError()}))}))},t.prototype.IsInTrustedHostList=function(e){if(this.IsValidationEnabled&&!Object.keys(ot).length)throw fe.createKnownAuthoritiesNotSetError();return ot[e.toLowerCase()]},t.B2C_PREFIX="tfp",t}(rt),at=function(){function e(){}return e.setKnownAuthorities=function(e,t){e&&!Object.keys(ot).length&&t.forEach((function(e){ot[e]=e}))},e.saveMetadataFromNetwork=function(e,t,r){return a(this,void 0,void 0,(function(){var n;return s(this,(function(o){switch(o.label){case 0:return[4,e.resolveEndpointsAsync(t,r)];case 1:return n=o.sent(),this.metadataMap.set(e.CanonicalAuthority,n),[2,n]}}))}))},e.getMetadata=function(e){return this.metadataMap.get(e)},e.saveMetadataFromConfig=function(e,t){try{if(t){var r=JSON.parse(t);if(!r.authorization_endpoint||!r.end_session_endpoint||!r.issuer)throw fe.createInvalidAuthorityMetadataError();this.metadataMap.set(e,{AuthorizationEndpoint:r.authorization_endpoint,EndSessionEndpoint:r.end_session_endpoint,Issuer:r.issuer})}}catch(e){throw fe.createInvalidAuthorityMetadataError()}},e.detectAuthorityFromUrl=function(e){return e=me.CanonicalizeUri(e),"adfs"===me.GetUrlComponents(e).PathSegments[0]?w.Adfs:Object.keys(ot).length?w.B2C:w.Aad},e.CreateInstance=function(t,r,n){if(S.isEmpty(t))return null;switch(n&&this.saveMetadataFromConfig(t,n),e.detectAuthorityFromUrl(t)){case w.B2C:return new it(t,r,this.getMetadata(t));case w.Aad:return new nt(t,r,this.getMetadata(t));default:throw fe.createInvalidAuthorityTypeError()}},e.metadataMap=new Map,e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(tt||(tt={}));var st=function(){function e(e,t){void 0===t&&(t={}),this.level=tt.Info;var r=t.correlationId,n=void 0===r?"":r,o=t.level,i=void 0===o?tt.Info:o,a=t.piiLoggingEnabled,s=void 0!==a&&a;this.localCallback=e,this.correlationId=n,this.level=i,this.piiLoggingEnabled=s}return e.prototype.logMessage=function(e,t,r){if(!(e>this.level||!this.piiLoggingEnabled&&r)){var n,o=(new Date).toUTCString();n=S.isEmpty(this.correlationId)?o+":1.3.2-"+tt[e]+(r?"-pii":"")+" "+t:o+":"+this.correlationId+"-1.3.2-"+tt[e]+(r?"-pii":"")+" "+t,this.executeCallback(e,n,r)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e){this.logMessage(tt.Error,e,!1)},e.prototype.errorPii=function(e){this.logMessage(tt.Error,e,!0)},e.prototype.warning=function(e){this.logMessage(tt.Warning,e,!1)},e.prototype.warningPii=function(e){this.logMessage(tt.Warning,e,!0)},e.prototype.info=function(e){this.logMessage(tt.Info,e,!1)},e.prototype.infoPii=function(e){this.logMessage(tt.Info,e,!0)},e.prototype.verbose=function(e){this.logMessage(tt.Verbose,e,!1)},e.prototype.verbosePii=function(e){this.logMessage(tt.Verbose,e,!0)},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},e}(),ct={clientId:"",authority:null,validateAuthority:!0,authorityMetadata:"",knownAuthorities:[],redirectUri:function(){return me.getCurrentUrl()},postLogoutRedirectUri:function(){return me.getCurrentUrl()},navigateToLoginRequestUrl:!0},ut={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},lt={logger:new st(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},ht={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map};var dt={code:"server_unavailable",desc:"Server is temporarily unavailable."},pt={code:"unknown_server_error"},ft=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ServerError",Object.setPrototypeOf(o,t.prototype),o}return o(t,e),t.createServerUnavailableError=function(){return new t(dt.code,dt.desc)},t.createUnknownServerError=function(e){return new t(pt.code,e)},t}(b),gt={code:"interaction_required"},mt={code:"consent_required"},yt={code:"login_required"},vt=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="InteractionRequiredAuthError",Object.setPrototypeOf(o,t.prototype),o}return o(t,e),t.isInteractionRequiredError=function(e){var t=[gt.code,mt.code,yt.code];return e&&t.indexOf(e)>-1},t.createLoginRequiredAuthError=function(e){return new t(yt.code,e)},t.createInteractionRequiredAuthError=function(e){return new t(gt.code,e)},t.createConsentRequiredAuthError=function(e){return new t(mt.code,e)},t}(ft);function It(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e,fromCache:!1}}var wt,Et,Tt,bt=function(e){function t(t,r,n,o){var i=e.call(this,je("default_event"),r,"DefaultEvent")||this;return i.event[je("client_id")]=n,i.event[je("sdk_plaform")]=t.sdk,i.event[je("sdk_version")]=t.sdkVersion,i.event[je("application_name")]=t.applicationName,i.event[je("application_version")]=t.applicationVersion,i.event[je("effective_connection_speed")]=t.networkInformation&&t.networkInformation.connectionSpeed,i.event[""+qe]=i.getEventCount(je("ui_event"),o),i.event[""+Le]=i.getEventCount(je("http_event"),o),i.event[""+xe]=i.getEventCount(je("cache_event"),o),i}return o(t,e),t.prototype.getEventCount=function(e,t){return t[e]?t[e]:0},t}(Fe),St=je("authority"),Ct=je("authority_type"),At=je("ui_behavior"),kt=je("tenant_id"),_t=je("user_id"),Ot=je("was_successful"),Rt=je("api_error_code"),Pt=je("login_hint");!function(e){e[e.AcquireTokenRedirect=2001]="AcquireTokenRedirect",e[e.AcquireTokenSilent=2002]="AcquireTokenSilent",e[e.AcquireTokenPopup=2003]="AcquireTokenPopup",e[e.LoginRedirect=2004]="LoginRedirect",e[e.LoginPopup=2005]="LoginPopup",e[e.Logout=2006]="Logout"}(Et||(Et={})),function(e){e.AcquireTokenRedirect="AcquireTokenRedirect",e.AcquireTokenSilent="AcquireTokenSilent",e.AcquireTokenPopup="AcquireTokenPopup",e.LoginRedirect="LoginRedirect",e.LoginPopup="LoginPopup",e.Logout="Logout"}(Tt||(Tt={}));var Nt=((wt={})[Tt.AcquireTokenSilent]=Et.AcquireTokenSilent,wt[Tt.AcquireTokenPopup]=Et.AcquireTokenPopup,wt[Tt.AcquireTokenRedirect]=Et.AcquireTokenRedirect,wt[Tt.LoginPopup]=Et.LoginPopup,wt[Tt.LoginRedirect]=Et.LoginRedirect,wt[Tt.Logout]=Et.Logout,wt),Ut=function(e){function t(t,r,n){var o=e.call(this,je("api_event"),t,n)||this;return n&&(o.apiCode=Nt[n],o.apiEventIdentifier=n),o.piiEnabled=r,o}return o(t,e),Object.defineProperty(t.prototype,"apiEventIdentifier",{set:function(e){this.event[Ne]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiCode",{set:function(e){this.event[Ue]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authority",{set:function(e){this.event[St]=Me(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiErrorCode",{set:function(e){this.event[Rt]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tenantId",{set:function(e){this.event[kt]=this.piiEnabled&&e?De(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"accountId",{set:function(e){this.event[_t]=this.piiEnabled&&e?De(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wasSuccessful",{get:function(){return!0===this.event[Ot]},set:function(e){this.event[Ot]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loginHint",{set:function(e){this.event[Pt]=this.piiEnabled&&e?De(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authorityType",{set:function(e){this.event[Ct]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promptType",{set:function(e){this.event[At]=e.toLowerCase()},enumerable:!0,configurable:!0}),t}(Fe),xt=function(){function e(e,t,r){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=i({sdk:p.libraryName,sdkVersion:"1.3.2",networkInformation:{connectionSpeed:"undefined"!=typeof navigator&&navigator.connection&&navigator.connection.effectiveType}},e.platform),this.clientId=e.clientId,this.onlySendFailureTelemetry=e.onlySendFailureTelemetry,this.telemetryEmitter=t,this.logger=r}return e.getTelemetrymanagerStub=function(e,t){return new this({platform:{applicationName:"UnSetStub",applicationVersion:"0.0"},clientId:e},(function(){}),t)},e.prototype.startEvent=function(e){this.logger.verbose("Telemetry Event started: "+e.key),this.telemetryEmitter&&(e.start(),this.inProgressEvents[e.key]=e)},e.prototype.stopEvent=function(e){if(this.logger.verbose("Telemetry Event stopped: "+e.key),this.telemetryEmitter&&this.inProgressEvents[e.key]){e.stop(),this.incrementEventCount(e);var t=this.completedEvents[e.telemetryCorrelationId];this.completedEvents[e.telemetryCorrelationId]=(t||[]).concat([e]),delete this.inProgressEvents[e.key]}},e.prototype.flush=function(e){var t=this;if(this.logger.verbose("Flushing telemetry events: "+e),this.telemetryEmitter&&this.completedEvents[e]){var r=this.getOrphanedEvents(e);r.forEach((function(e){return t.incrementEventCount(e)}));var n=this.completedEvents[e].concat(r);delete this.completedEvents[e];var o=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],n&&n.length){var i=new bt(this.telemetryPlatform,e,this.clientId,o),a=n.concat([i]);this.telemetryEmitter(a.map((function(e){return e.get()})))}}},e.prototype.createAndStartApiEvent=function(e,t){var r=new Ut(e,this.logger.isPiiLoggingEnabled(),t);return this.startEvent(r),r},e.prototype.stopAndFlushApiEvent=function(e,t,r,n){t.wasSuccessful=r,n&&(t.apiErrorCode=n),this.stopEvent(t),this.flush(e)},e.prototype.createAndStartHttpEvent=function(e,t,r,n){var o=new et(e,n);return o.url=r,o.httpMethod=t,this.startEvent(o),o},e.prototype.incrementEventCount=function(e){var t,r=e.eventName,n=this.eventCountByCorrelationId[e.telemetryCorrelationId];n?n[r]=n[r]?n[r]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=((t={})[r]=1,t)},e.prototype.getOrphanedEvents=function(e){var t=this;return Object.keys(this.inProgressEvents).reduce((function(r,n){if(-1!==n.indexOf(e)){var o=t.inProgressEvents[n];return delete t.inProgressEvents[n],r.concat([o])}return r}),[])},e}(),Lt="id_token",qt="token",Mt="id_token token",Dt=function(){function e(e){var t,r,n,o,a,s,c,u;this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=(r=(t=e).auth,n=t.cache,o=void 0===n?{}:n,a=t.system,s=void 0===a?{}:a,c=t.framework,u=void 0===c?{}:c,{auth:i({},ct,r),cache:i({},ut,o),system:i({},lt,s),framework:i({},ht,u)}),this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),at.setKnownAuthorities(this.config.auth.validateAuthority,this.config.auth.knownAuthorities),at.saveMetadataFromConfig(this.config.auth.authority,this.config.auth.authorityMetadata),this.authority=this.config.auth.authority||"https://login.microsoftonline.com/common",this.cacheStorage=new Se(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals={},window.renewStates=[],window.callbackMappedToRenewStates={},window.promiseMappedToRenewStates={},window.msal=this;var l=window.location.hash,h=me.urlContainsHash(l);(Ae.checkIfBackButtonIsPressed(this.cacheStorage),h)&&(this.getResponseState(l).method===p.interactionTypeRedirect&&this.handleRedirectAuthenticationResponse(l))}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=at.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!0,configurable:!0}),e.prototype.getAuthorityInstance=function(){return this.authorityInstance},e.prototype.handleRedirectCallback=function(e,t){if(!e)throw fe.createInvalidCallbackObjectError(e);t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectError?this.authErrorHandler(p.interactionTypeRedirect,this.redirectError,this.redirectResponse):this.redirectResponse&&this.authResponseHandler(p.interactionTypeRedirect,this.redirectResponse)},e.prototype.urlContainsHash=function(e){return me.urlContainsHash(e)},e.prototype.authResponseHandler=function(e,t,r){if(e===p.interactionTypeRedirect)this.errorReceivedCallback?this.tokenReceivedCallback(t):this.authResponseCallback&&this.authResponseCallback(null,t);else{if(e!==p.interactionTypePopup)throw J.createInvalidInteractionTypeError();r(t)}},e.prototype.authErrorHandler=function(e,t,r,n){if(this.cacheStorage.removeItem(u.INTERACTION_STATUS),e===p.interactionTypeRedirect)this.errorReceivedCallback?this.errorReceivedCallback(t,r.accountState):this.authResponseCallback(t,r);else{if(e!==p.interactionTypePopup)throw J.createInvalidInteractionTypeError();n(t)}},e.prototype.loginRedirect=function(e){var t=_e.validateRequest(e,!0,this.clientId,p.interactionTypeRedirect);this.acquireTokenInteractive(p.interactionTypeRedirect,!0,t,null,null)},e.prototype.acquireTokenRedirect=function(e){var t=_e.validateRequest(e,!1,this.clientId,p.interactionTypeRedirect);this.acquireTokenInteractive(p.interactionTypeRedirect,!1,t,null,null)},e.prototype.loginPopup=function(e){var t=this,r=_e.validateRequest(e,!0,this.clientId,p.interactionTypePopup),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,Tt.LoginPopup);return new Promise((function(e,n){t.acquireTokenInteractive(p.interactionTypePopup,!0,r,e,n)})).then((function(e){return t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,e.errorCode),e}))},e.prototype.acquireTokenPopup=function(e){var t=this;this.logger.verbose("AcquireTokenPopup has been called");var r=_e.validateRequest(e,!1,this.clientId,p.interactionTypePopup),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,Tt.AcquireTokenPopup);return new Promise((function(e,n){t.acquireTokenInteractive(p.interactionTypePopup,!1,r,e,n)})).then((function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,e.errorCode),e}))},e.prototype.acquireTokenInteractive=function(e,t,r,n,o){var i=this;this.logger.verbose("AcquireTokenInteractive has been called"),Ae.blockReloadInHiddenIframes();var a,s=this.cacheStorage.getItem(u.INTERACTION_STATUS);if(e===p.interactionTypeRedirect&&this.cacheStorage.setItem(u.REDIRECT_REQUEST,""+p.inProgress+p.resourceDelimiter+r.state),s===p.inProgress){var c=t?J.createLoginInProgressError():J.createAcquireTokenInProgressError(),l=It(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,c,l,o)}if(r&&r.account&&!t?(a=r.account,this.logger.verbose("Account set from request")):(a=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),a||Ie.isSSOParam(r))this.logger.verbose("User session exists, login not required"),this.acquireTokenHelper(a,e,t,r,n,o);else{if(!t){this.logger.verbose("AcquireToken call, no context or account given"),this.logger.info("User login is required");l=It(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,J.createUserLoginRequiredError(),l,o)}if(this.extractADALIdToken()&&!r.scopes){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken");var h=this.buildIDTokenRequest(r);this.silentLogin=!0,this.acquireTokenSilent(h).then((function(t){i.silentLogin=!1,i.logger.info("Unified cache call is successful"),i.authResponseHandler(e,t,n)}),(function(a){i.silentLogin=!1,i.logger.error("Error occurred during unified cache ATS: "+a),i.acquireTokenHelper(null,e,t,r,n,o)}))}else this.logger.verbose("Login call but no token found, proceed to login"),this.acquireTokenHelper(null,e,t,r,n,o)}},e.prototype.acquireTokenHelper=function(e,t,r,n,o,i){return a(this,void 0,void 0,(function(){var a,c,l,d,f,g,m,y,v,I;return s(this,(function(s){switch(s.label){case 0:this.cacheStorage.setItem(u.INTERACTION_STATUS,p.inProgress),a=n.scopes?n.scopes.join(" ").toLowerCase():this.clientId.toLowerCase(),l=n&&n.authority?at.CreateInstance(n.authority,this.config.auth.validateAuthority,n.authorityMetadata):this.authorityInstance,s.label=1;case 1:return s.trys.push([1,11,,12]),l.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,at.saveMetadataFromNetwork(l,this.telemetryManager,n.correlationId)]);case 2:return s.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),s.label=4;case 4:if(f=r?Lt:this.getTokenType(e,n.scopes,!1),g=n.redirectStartPage||window.location.href,c=new Ie(l,this.clientId,f,this.getRedirectUri(n&&n.redirectUri),n.scopes,n.state,n.correlationId),this.updateCacheEntries(c,e,r,g),c.populateQueryParams(e,n),m=me.createNavigateUrl(c)+p.response_mode_fragment,t===p.interactionTypeRedirect)r||this.cacheStorage.setItem(""+u.STATE_ACQ_TOKEN+p.resourceDelimiter+n.state,c.state,this.inCookie);else{if(t!==p.interactionTypePopup)throw J.createInvalidInteractionTypeError();window.renewStates.push(c.state),window.requestType=r?p.login:p.renewToken,this.registerCallback(c.state,a,o,i)}if(t!==p.interactionTypePopup)return[3,9];try{d=this.openPopup(m,"msal",p.popUpWidth,p.popUpHeight),Ae.trackPopup(d)}catch(e){if(this.logger.info(_.code+":"+_.desc),this.cacheStorage.setItem(h.ERROR,_.code),this.cacheStorage.setItem(h.ERROR_DESC,_.desc),i)return i(J.createPopupWindowError()),[2]}if(!d)return[3,8];s.label=5;case 5:return s.trys.push([5,7,,8]),[4,Ae.monitorWindowForHash(d,this.config.system.loadFrameTimeout,m,this.logger)];case 6:return y=s.sent(),this.handleAuthenticationResponse(y),this.cacheStorage.removeItem(u.INTERACTION_STATUS),this.logger.info("Closing popup window"),this.config.framework.isAngular&&(this.broadcast("msal:popUpHashChanged",y),Ae.closePopups()),[3,8];case 7:return v=s.sent(),i&&i(v),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",v.errorCode+p.resourceDelimiter+v.errorMessage):(this.cacheStorage.removeItem(u.INTERACTION_STATUS),d.close()),[3,8];case 8:return[3,10];case 9:n.onRedirectNavigate?(this.logger.verbose("Invoking onRedirectNavigate callback"),!1!==n.onRedirectNavigate(m)?(this.logger.verbose("onRedirectNavigate did not return false, navigating"),this.navigateWindow(m)):this.logger.verbose("onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(m)),s.label=10;case 10:return[3,12];case 11:return I=s.sent(),this.logger.error(I),this.cacheStorage.resetTempCacheItems(n.state),this.authErrorHandler(t,J.createEndpointResolutionError(I.toString),It(n.state),i),d&&d.close(),[3,12];case 12:return[2]}}))}))},e.prototype.ssoSilent=function(e){if(!e)throw fe.createEmptyRequestError();if(!e.sid&&!e.loginHint)throw fe.createSsoSilentError();return this.acquireTokenSilent(i({},e,{scopes:[this.clientId]}))},e.prototype.acquireTokenSilent=function(e){var t=this;this.logger.verbose("AcquireTokenSilent has been called");var r=_e.validateRequest(e,!1,this.clientId,p.interactionTypeSilent),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,Tt.AcquireTokenSilent),o=_e.createRequestSignature(r);return new Promise((function(e,n){return a(t,void 0,void 0,(function(){var t,i,a,c,u,l,h,d,f,g,m;return s(this,(function(s){switch(s.label){case 0:if(Ae.blockReloadInHiddenIframes(),t=r.scopes.join(" ").toLowerCase(),this.logger.verbosePii("Serialized scopes: "+t),r.account?(i=r.account,this.logger.verbose("Account set from request")):(i=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),a=this.cacheStorage.getItem(p.adalIdToken),!i&&!r.sid&&!r.loginHint&&S.isEmpty(a))return this.logger.info("User login is required"),[2,n(J.createUserLoginRequiredError())];if(c=this.getTokenType(i,r.scopes,!0),this.logger.verbose("Response type: "+c),u=new Ie(at.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata),this.clientId,c,this.getRedirectUri(r.redirectUri),r.scopes,r.state,r.correlationId),this.logger.verbose("Finished building server authentication request"),Ie.isSSOParam(r)||i?(u.populateQueryParams(i,r,null,!0),this.logger.verbose("Query parameters populated from existing SSO or account")):i||S.isEmpty(a)?this.logger.verbose("No additional query parameters added"):(l=Ee.extractIdToken(a),this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters"),u.populateQueryParams(i,null,l,!0)),!(h=r.claimsRequest||u.claimsValue)&&!r.forceRefresh)try{f=this.getCachedToken(u,i)}catch(e){d=e}return f?(this.logger.verbose("Token is already in cache for scope: "+t),e(f),[2,null]):[3,1];case 1:return d?(this.logger.infoPii(d.errorCode+":"+d.errorMessage),n(d),[2,null]):[3,2];case 2:g=void 0,g=h?"Skipped cache lookup since claims were given":r.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"Token is not in cache for scope: "+t,this.logger.verbose(g),u.authorityInstance||(u.authorityInstance=r.authority?at.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata):this.authorityInstance),this.logger.verbosePii("Authority instance: "+u.authority),s.label=3;case 3:return s.trys.push([3,7,,8]),u.authorityInstance.hasCachedMetadata()?[3,5]:(this.logger.verbose("No cached metadata for authority"),[4,at.saveMetadataFromNetwork(u.authorityInstance,this.telemetryManager,r.correlationId)]);case 4:return s.sent(),this.logger.verbose("Authority has been updated with endpoint discovery response"),[3,6];case 5:this.logger.verbose("Cached metadata found for authority"),s.label=6;case 6:return window.activeRenewals[o]?(this.logger.verbose("Renew token for scope and authority: "+o+" is in progress. Registering callback"),this.registerCallback(window.activeRenewals[o],o,e,n)):r.scopes&&r.scopes.indexOf(this.clientId)>-1&&1===r.scopes.length?(this.logger.verbose("Renewing idToken"),this.silentLogin=!0,this.renewIdToken(o,e,n,i,u)):(this.logger.verbose("Renewing accesstoken"),this.renewToken(o,e,n,i,u)),[3,8];case 7:return m=s.sent(),this.logger.error(m),n(J.createEndpointResolutionError(m.toString())),[2,null];case 8:return[2]}}))}))})).then((function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,e.errorCode),e}))},e.prototype.openPopup=function(e,t,r,n){try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=a/2-r/2+o,l=s/2-n/2+i,h=window.open(e,t,"width="+r+", height="+n+", top="+l+", left="+c+", scrollbars=yes");if(!h)throw J.createPopupWindowError();return h.focus&&h.focus(),h}catch(e){throw this.logger.error("error opening popup "+e.message),this.cacheStorage.removeItem(u.INTERACTION_STATUS),J.createPopupWindowError(e.toString())}},e.prototype.loadIframeTimeout=function(e,t,r){return a(this,void 0,void 0,(function(){var n,o,i,a,c;return s(this,(function(s){switch(s.label){case 0:return n=window.activeRenewals[r],this.logger.verbosePii("Set loading state to pending for: "+r+":"+n),this.cacheStorage.setItem(""+u.RENEW_STATUS+p.resourceDelimiter+n,p.inProgress),this.config.system.navigateFrameWait?[4,Ae.loadFrame(e,t,this.config.system.navigateFrameWait,this.logger)]:[3,2];case 1:return i=s.sent(),[3,3];case 2:i=Ae.loadFrameSync(e,t,this.logger),s.label=3;case 3:o=i,s.label=4;case 4:return s.trys.push([4,6,,7]),[4,Ae.monitorWindowForHash(o.contentWindow,this.config.system.loadFrameTimeout,e,this.logger,!0)];case 5:return(a=s.sent())&&this.handleAuthenticationResponse(a),[3,7];case 6:throw c=s.sent(),this.cacheStorage.getItem(""+u.RENEW_STATUS+p.resourceDelimiter+n)===p.inProgress&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope/authority "+r+":"+n),n&&window.callbackMappedToRenewStates[n]&&window.callbackMappedToRenewStates[n](null,c),this.cacheStorage.removeItem(""+u.RENEW_STATUS+p.resourceDelimiter+n)),Ae.removeHiddenIframe(o),c;case 7:return Ae.removeHiddenIframe(o),[2]}}))}))},e.prototype.navigateWindow=function(e,t){if(!e||S.isEmpty(e))throw this.logger.info("Navigate url is empty"),b.createUnexpectedError("Navigate url is empty");var r=t||window,n=t?"Navigated Popup window to:"+e:"Navigate to:"+e;this.logger.infoPii(n),r.location.assign(e)},e.prototype.registerCallback=function(e,t,r,n){var o=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:r,reject:n}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(r,n){window.activeRenewals[t]=null;for(var i=0;i<window.promiseMappedToRenewStates[e].length;++i)try{if(n)window.promiseMappedToRenewStates[e][i].reject(n);else{if(!r)throw o.cacheStorage.resetTempCacheItems(e),b.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[e][i].resolve(r)}}catch(e){o.logger.warning(e)}window.promiseMappedToRenewStates[e]=null,window.callbackMappedToRenewStates[e]=null})},e.prototype.logout=function(e){this.logoutAsync(e)},e.prototype.logoutAsync=function(e){return a(this,void 0,void 0,(function(){var t,r,n,o,i,a;return s(this,(function(s){switch(s.label){case 0:t=e||d.createNewGuid(),r=this.telemetryManager.createAndStartApiEvent(t,Tt.Logout),this.clearCache(),this.account=null,s.label=1;case 1:return s.trys.push([1,5,,6]),this.authorityInstance.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,at.saveMetadataFromNetwork(this.authorityInstance,this.telemetryManager,e)]);case 2:return s.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),s.label=4;case 4:return n="client-request-id="+t,o=this.getPostLogoutRedirectUri()?"&post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()):"",i=this.authorityInstance.EndSessionEndpoint?this.authorityInstance.EndSessionEndpoint+"?"+n+o:this.authority+"oauth2/v2.0/logout?"+n+o,this.telemetryManager.stopAndFlushApiEvent(t,r,!0),this.navigateWindow(i),[3,6];case 5:return a=s.sent(),this.telemetryManager.stopAndFlushApiEvent(t,r,!1,a.errorCode),[3,6];case 6:return[2]}}))}))},e.prototype.clearCache=function(){window.renewStates=[];for(var e=this.cacheStorage.getAllAccessTokens(p.clientId,p.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie()},e.prototype.clearCacheForScope=function(e){for(var t=this.cacheStorage.getAllAccessTokens(p.clientId,p.homeAccountIdentifier),r=0;r<t.length;r++){var n=t[r];n.value.accessToken===e&&this.cacheStorage.removeItem(JSON.stringify(n.key))}},e.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),me.urlContainsHash(e)},e.prototype.processCallBack=function(e,t,r){var n,o;this.logger.info("Processing the callback from redirect response"),t||(t=this.getResponseState(e));try{n=this.saveTokenFromHash(e,t)}catch(e){o=e}try{this.cacheStorage.clearMsalCookie(t.state);var i=this.getAccountState(t.state);if(n){if(t.requestType===p.renewToken||n.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("acquiring token interactive in progress"),n.tokenType=c.ACCESS_TOKEN):t.requestType===p.login&&(n.tokenType=c.ID_TOKEN),!r)return void(this.redirectResponse=n)}else if(!r)return this.redirectResponse=It(i),this.redirectError=o,void this.cacheStorage.resetTempCacheItems(t.state);r(n,o)}catch(e){throw this.logger.error("Error occurred in token received callback function: "+e),J.createErrorInCallbackFunction(e.toString())}},e.prototype.handleAuthenticationResponse=function(e){var t=e||window.location.hash,r=this.getResponseState(t),n=window.callbackMappedToRenewStates[r.state];this.processCallBack(t,r,n),Ae.closePopups()},e.prototype.handleRedirectAuthenticationResponse=function(e){this.logger.info("Returned from redirect url"),window.location.hash="";var t=this.getResponseState(e);if(this.config.auth.navigateToLoginRequestUrl&&window.parent===window){var r=this.cacheStorage.getItem(""+u.LOGIN_REQUEST+p.resourceDelimiter+t.state,this.inCookie);if(!r||"null"===r)return this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),void window.location.assign("/");var n=me.removeHashFromUrl(window.location.href),o=me.removeHashFromUrl(r);if(n!==o)return void window.location.assign(""+o+e);var i=me.GetUrlComponents(r);i.Hash&&(window.location.hash=i.Hash)}this.processCallBack(e,t,null)},e.prototype.getResponseState=function(e){var t,r=me.deserializeHash(e);if(!r)throw b.createUnexpectedError("Hash was not parsed correctly.");if(!r.hasOwnProperty(c.STATE))throw b.createUnexpectedError("Hash does not contain state.");var n=_e.parseLibraryState(r.state);if((t={requestType:p.unknown,state:r.state,timestamp:n.ts,method:n.method,stateMatch:!1}).state===this.cacheStorage.getItem(""+u.STATE_LOGIN+p.resourceDelimiter+t.state,this.inCookie)||t.state===this.silentAuthenticationState)return t.requestType=p.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(""+u.STATE_ACQ_TOKEN+p.resourceDelimiter+t.state,this.inCookie))return t.requestType=p.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){t.requestType=window.requestType;for(var o=window.renewStates,i=0;i<o.length;i++)if(o[i]===t.state){t.stateMatch=!0;break}}return t},e.prototype.getCachedToken=function(e,t){var r=null,n=e.scopes,o=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null);if(0===o.length)return null;var i=[];if(e.authority){for(a=0;a<o.length;a++){u=(s=o[a]).key.scopes.split(" ");ge.containsScope(u,n)&&me.CanonicalizeUri(s.key.authority)===e.authority&&i.push(s)}if(0===i.length)return null;if(1!==i.length)throw J.createMultipleMatchingTokensInCacheError(n.toString());r=i[0]}else{for(var a=0;a<o.length;a++){var s,u=(s=o[a]).key.scopes.split(" ");ge.containsScope(u,n)&&i.push(s)}if(1===i.length)r=i[0],e.authorityInstance=at.CreateInstance(r.key.authority,this.config.auth.validateAuthority);else{if(i.length>1)throw J.createMultipleMatchingTokensInCacheError(n.toString());var l=this.getUniqueAuthority(o,"authority");if(l.length>1)throw J.createMultipleAuthoritiesInCacheError(n.toString());e.authorityInstance=at.CreateInstance(l[0],this.config.auth.validateAuthority)}}if(null!=r){var h=Number(r.value.expiresIn),d=this.config.system.tokenRenewalOffsetSeconds||300;if(h&&h>ke.now()+d){var p=new Te(r.value.idToken);if(!t&&!(t=this.getAccount()))throw b.createUnexpectedError("Account should not be null here.");var f=this.getAccountState(e.state),g={uniqueId:"",tenantId:"",tokenType:r.value.idToken===r.value.accessToken?c.ID_TOKEN:c.ACCESS_TOKEN,idToken:p,idTokenClaims:p.claims,accessToken:r.value.accessToken,scopes:r.key.scopes.split(" "),expiresOn:new Date(1e3*h),account:t,accountState:f,fromCache:!0};return Oe.setResponseIdToken(g,p),g}return this.cacheStorage.removeItem(JSON.stringify(i[0].key)),null}return null},e.prototype.getUniqueAuthority=function(e,t){var r=[],n=[];return e.forEach((function(e){e.key.hasOwnProperty(t)&&-1===n.indexOf(e.key[t])&&(n.push(e.key[t]),r.push(e.key[t]))})),r},e.prototype.extractADALIdToken=function(){var e=this.cacheStorage.getItem(p.adalIdToken);return S.isEmpty(e)?null:Ee.extractIdToken(e)},e.prototype.renewToken=function(e,t,r,n,o){this.logger.verbose("renewToken is called for scope and authority: "+e);var i=Ae.generateFrameName(I,e);Ae.addHiddenIFrame(i,this.logger),this.updateCacheEntries(o,n,!1),this.logger.verbosePii("Renew token Expected state: "+o.state);var a=me.urlRemoveQueryStringParameter(me.createNavigateUrl(o),p.prompt)+p.prompt_none+p.response_mode_fragment;window.renewStates.push(o.state),window.requestType=p.renewToken,this.registerCallback(o.state,e,t,r),this.logger.infoPii("Navigate to:"+a),this.loadIframeTimeout(a,i,e).catch((function(e){return r(e)}))},e.prototype.renewIdToken=function(e,t,r,n,o){this.logger.info("renewidToken is called");var i=Ae.generateFrameName(v,e);Ae.addHiddenIFrame(i,this.logger),this.updateCacheEntries(o,n,!1),this.logger.verbose("Renew Idtoken Expected state: "+o.state);var a=me.urlRemoveQueryStringParameter(me.createNavigateUrl(o),p.prompt)+p.prompt_none+p.response_mode_fragment;this.silentLogin?(window.requestType=p.login,this.silentAuthenticationState=o.state):(window.requestType=p.renewToken,window.renewStates.push(o.state)),this.registerCallback(o.state,e,t,r),this.logger.infoPii("Navigate to:"+a),this.loadIframeTimeout(a,i,e).catch((function(e){return r(e)}))},e.prototype.saveAccessToken=function(e,t,r,n,o){var a,s,u=i({},e),l=new we(n);if(r.hasOwnProperty(c.SCOPE)){for(var h=(a=r[c.SCOPE]).split(" "),d=this.cacheStorage.getAllAccessTokens(this.clientId,t),p=0;p<d.length;p++){var f=d[p];if(f.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var g=f.key.scopes.split(" ");ge.isIntersectingScopes(g,h)&&this.cacheStorage.removeItem(JSON.stringify(f.key))}}var m=ke.parseExpiresIn(r[c.EXPIRES_IN]);s=_e.parseLibraryState(r[c.STATE]).ts+m;var y=new ye(t,this.clientId,a,l.uid,l.utid),v=new ve(r[c.ACCESS_TOKEN],o.rawIdToken,s.toString(),n);this.cacheStorage.setItem(JSON.stringify(y),JSON.stringify(v)),u.accessToken=r[c.ACCESS_TOKEN],u.scopes=h}else{a=this.clientId;y=new ye(t,this.clientId,a,l.uid,l.utid);s=Number(o.expiration);v=new ve(r[c.ID_TOKEN],r[c.ID_TOKEN],s.toString(),n);this.cacheStorage.setItem(JSON.stringify(y),JSON.stringify(v)),u.scopes=[a],u.accessToken=r[c.ID_TOKEN]}return s?u.expiresOn=new Date(1e3*s):this.logger.error("Could not parse expiresIn parameter"),u},e.prototype.saveTokenFromHash=function(e,t){this.logger.info("State status:"+t.stateMatch+"; Request type:"+t.requestType);var r,n={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},o=me.deserializeHash(e),i="",a="",s=null;if(o.hasOwnProperty(c.ERROR_DESCRIPTION)||o.hasOwnProperty(c.ERROR)){if(this.logger.infoPii("Error :"+o[c.ERROR]+"; Error description:"+o[c.ERROR_DESCRIPTION]),this.cacheStorage.setItem(h.ERROR,o[c.ERROR]),this.cacheStorage.setItem(h.ERROR_DESC,o[c.ERROR_DESCRIPTION]),t.requestType===p.login&&(this.cacheStorage.setItem(h.LOGIN_ERROR,o[c.ERROR_DESCRIPTION]+":"+o[c.ERROR]),i=Se.generateAuthorityKey(t.state)),t.requestType===p.renewToken){i=Se.generateAuthorityKey(t.state);var d=this.getAccount(),f=void 0;f=d&&!S.isEmpty(d.homeAccountIdentifier)?d.homeAccountIdentifier:p.no_account,a=Se.generateAcquireTokenAccountKey(f,t.state)}var g=o[c.ERROR],m=o[c.ERROR_DESCRIPTION];r=vt.isInteractionRequiredError(g)||vt.isInteractionRequiredError(m)?new vt(o[c.ERROR],o[c.ERROR_DESCRIPTION]):new ft(o[c.ERROR],o[c.ERROR_DESCRIPTION])}else if(t.stateMatch){this.logger.info("State is right"),o.hasOwnProperty(c.SESSION_STATE)&&this.cacheStorage.setItem(""+u.SESSION_STATE+p.resourceDelimiter+t.state,o[c.SESSION_STATE]),n.accountState=this.getAccountState(t.state);var y="";if(o.hasOwnProperty(c.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),n.accessToken=o[c.ACCESS_TOKEN],o.hasOwnProperty(c.SCOPE)&&(n.scopes=o[c.SCOPE].split(" ")),o.hasOwnProperty(c.ID_TOKEN)?(s=new Te(o[c.ID_TOKEN]),n.idToken=s,n.idTokenClaims=s.claims):(s=new Te(this.cacheStorage.getItem(l.IDTOKEN)),n=Oe.setResponseIdToken(n,s));var v=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,s);if(!o.hasOwnProperty(c.CLIENT_INFO))throw this.logger.warning("ClientInfo not received in the response from AAD"),J.createClientInfoNotPopulatedError("ClientInfo not received in the response from the server");y=o[c.CLIENT_INFO],n.account=Ce.createAccount(s,new we(y));var I=void 0;I=n.account&&!S.isEmpty(n.account.homeAccountIdentifier)?n.account.homeAccountIdentifier:p.no_account,a=Se.generateAcquireTokenAccountKey(I,t.state);var w=Se.generateAcquireTokenAccountKey(p.no_account,t.state),E=this.cacheStorage.getItem(a),T=void 0;S.isEmpty(E)?S.isEmpty(this.cacheStorage.getItem(w))||(n=this.saveAccessToken(n,v,o,y,s)):(T=JSON.parse(E),n.account&&T&&Ce.compareAccounts(n.account,T)?(n=this.saveAccessToken(n,v,o,y,s),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}if(o.hasOwnProperty(c.ID_TOKEN)){this.logger.info("Fragment has id token"),s=new Te(o[c.ID_TOKEN]),n=Oe.setResponseIdToken(n,s),o.hasOwnProperty(c.CLIENT_INFO)?y=o[c.CLIENT_INFO]:this.logger.warning("ClientInfo not received in the response from AAD");v=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,s);this.account=Ce.createAccount(s,new we(y)),n.account=this.account,s&&s.nonce?s.nonce!==this.cacheStorage.getItem(""+u.NONCE_IDTOKEN+p.resourceDelimiter+t.state,this.inCookie)?(this.account=null,this.cacheStorage.setItem(h.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+this.cacheStorage.getItem(""+u.NONCE_IDTOKEN+p.resourceDelimiter+t.state,this.inCookie)+",Actual Nonce: "+s.nonce),this.logger.error("Nonce Mismatch.Expected Nonce: "+this.cacheStorage.getItem(""+u.NONCE_IDTOKEN+p.resourceDelimiter+t.state,this.inCookie)+",Actual Nonce: "+s.nonce),r=J.createNonceMismatchError(this.cacheStorage.getItem(""+u.NONCE_IDTOKEN+p.resourceDelimiter+t.state,this.inCookie),s.nonce)):(this.cacheStorage.setItem(l.IDTOKEN,o[c.ID_TOKEN]),this.cacheStorage.setItem(l.CLIENT_INFO,y),this.saveAccessToken(n,v,o,y,s)):(i=t.state,a=t.state,this.logger.error("Invalid id_token received in the response"),r=J.createInvalidIdTokenError(s),this.cacheStorage.setItem(h.ERROR,r.errorCode),this.cacheStorage.setItem(h.ERROR_DESC,r.errorMessage))}}else{i=t.state,a=t.state;var C=this.cacheStorage.getItem(""+u.STATE_LOGIN+p.resourceDelimiter+t.state,this.inCookie);this.logger.error("State Mismatch.Expected State: "+C+",Actual State: "+t.state),r=J.createInvalidStateError(t.state,C),this.cacheStorage.setItem(h.ERROR,r.errorCode),this.cacheStorage.setItem(h.ERROR_DESC,r.errorMessage)}if(this.cacheStorage.removeItem(""+u.RENEW_STATUS+p.resourceDelimiter+t.state),this.cacheStorage.resetTempCacheItems(t.state),this.inCookie&&(this.cacheStorage.setItemCookie(i,"",-1),this.cacheStorage.clearMsalCookie(t.state)),r)throw r;if(!n)throw b.createUnexpectedError("Response is null");return n},e.prototype.populateAuthority=function(e,t,r,n){var o=Se.generateAuthorityKey(e),i=r.getItem(o,t);return S.isEmpty(i)?i:me.replaceTenantPath(i,n.tenantId)},e.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(l.IDTOKEN),t=this.cacheStorage.getItem(l.CLIENT_INFO);if(!S.isEmpty(e)&&!S.isEmpty(t)){var r=new Te(e),n=new we(t);return this.account=Ce.createAccount(r,n),this.account}return null},e.prototype.getAccountState=function(e){if(e){var t=e.indexOf(p.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return e},e.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(p.clientId,p.homeAccountIdentifier),r=0;r<t.length;r++){var n=new Te(t[r].value.idToken),o=new we(t[r].value.homeAccountIdentifier),i=Ce.createAccount(n,o);e.push(i)}return this.getUniqueAccounts(e)},e.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],r=[],n=0;n<e.length;++n)e[n].homeAccountIdentifier&&-1===t.indexOf(e[n].homeAccountIdentifier)&&(t.push(e[n].homeAccountIdentifier),r.push(e[n]));return r},e.prototype.broadcast=function(e,t){var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)},e.prototype.getCachedTokenInternal=function(e,t,r,n){var o=t||this.getAccount();if(!o)return null;var i=this.authorityInstance?this.authorityInstance:at.CreateInstance(this.authority,this.config.auth.validateAuthority),a=this.getTokenType(o,e,!0),s=new Ie(i,this.clientId,a,this.getRedirectUri(),e,r,n);return this.getCachedToken(s,t)},e.prototype.getScopesForEndpoint=function(e){if(this.config.framework.unprotectedResources.length>0)for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(e.indexOf(this.config.framework.unprotectedResources[t])>-1)return null;if(this.config.framework.protectedResourceMap.size>0)for(var r=0,n=Array.from(this.config.framework.protectedResourceMap.keys());r<n.length;r++){var o=n[r];if(e.indexOf(o)>-1)return this.config.framework.protectedResourceMap.get(o)}return e.indexOf("http://")>-1||e.indexOf("https://")>-1?me.getHostFromUri(e)===me.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},e.prototype.getLoginInProgress=function(){return this.cacheStorage.getItem(u.INTERACTION_STATUS)===p.inProgress},e.prototype.setInteractionInProgress=function(e){e?this.cacheStorage.setItem(u.INTERACTION_STATUS,p.inProgress):this.cacheStorage.removeItem(u.INTERACTION_STATUS)},e.prototype.setloginInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.getItem(u.INTERACTION_STATUS)===p.inProgress},e.prototype.setAcquireTokenInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.getRedirectUri=function(e){return e||("function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri)},e.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},e.prototype.getCurrentConfiguration=function(){if(!this.config)throw fe.createNoSetConfigurationError();return this.config},e.prototype.getTokenType=function(e,t,r){return r?Ce.compareAccounts(e,this.getAccount())?t.indexOf(this.config.auth.clientId)>-1?Lt:qt:t.indexOf(this.config.auth.clientId)>-1?Lt:Mt:Ce.compareAccounts(e,this.getAccount())?t.indexOf(this.clientId)>-1?Lt:qt:Mt},e.prototype.setAccountCache=function(e,t){var r=e?this.getAccountId(e):p.no_account,n=Se.generateAcquireTokenAccountKey(r,t);this.cacheStorage.setItem(n,JSON.stringify(e))},e.prototype.setAuthorityCache=function(e,t){var r=Se.generateAuthorityKey(e);this.cacheStorage.setItem(r,me.CanonicalizeUri(t),this.inCookie)},e.prototype.updateCacheEntries=function(e,t,r,n){n&&this.cacheStorage.setItem(""+u.LOGIN_REQUEST+p.resourceDelimiter+e.state,n,this.inCookie),r?this.cacheStorage.setItem(""+u.STATE_LOGIN+p.resourceDelimiter+e.state,e.state,this.inCookie):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(""+u.NONCE_IDTOKEN+p.resourceDelimiter+e.state,e.nonce,this.inCookie)},e.prototype.getAccountId=function(e){return S.isEmpty(e.homeAccountIdentifier)?p.no_account:e.homeAccountIdentifier},e.prototype.buildIDTokenRequest=function(e){return{scopes:[this.clientId],authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters,correlationId:e.correlationId}},e.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return xt.getTelemetrymanagerStub(t,this.logger);var r=e.applicationName,n=e.applicationVersion,o=e.telemetryEmitter;if(!r||!n||!o)throw fe.createTelemetryConfigError(e);return new xt({platform:{applicationName:r,applicationVersion:n},clientId:t},o,this.logger)},e}()}});
//# sourceMappingURL=fallbackauthdialog.js.map